<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.7.29">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>vidigi_vs_bupar â€“ vidigi</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = '/';
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-748b535e376f14d4692bf2b2e5fd6380.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-62440cb12cfa55836216392776f023db.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-28f787addce44b4ed5e48be3a6b58c55.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
     <script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>  
      </head>

  <body class="nav-sidebar docked quarto-notebook quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link"><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> View Imported Code, which has had logging steps added at the appropriate points in the â€˜modelâ€™ class</h6>

            <a href="../vidigi_docs/vidigi_vs_bupar.ipynb" class="btn btn-primary quarto-download-embed" download="vidigi_vs_bupar.ipynb">Download Notebook</a>
          </div>

     <div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../vidigi_docs/vidigi_vs_bupar.html">Other</a></li><li class="breadcrumb-item"><a href="../vidigi_docs/vidigi_vs_bupar.html">Vidigi vs BupaR</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">vidigi</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Bergam0t/vidigi" target="_blank">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Bergam0t/vidigi/issues" target="_blank">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-box-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://pypi.org/project/vidigi/" target="_blank">
            Download on pypi
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vidigi_docs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vidigi_docs/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Walkthroughs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vidigi_docs/adding_vidigi_to_a_simple_simpy_model_hsma_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adding Vidigi to a Simple simpy Model (HSMA Structure)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Details</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vidigi_docs/populating_event_logs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Populating Event Logs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_1_simplest_case/ex_1_simplest_case.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 1: Simplest Case</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_2_branching_multistep/ex_2_branching_multistep_case.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 2: Branching + Multi-step Case</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_3_simplest_case_priority_resource/ex_3_simplest_case_priority_resource.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 3: Simplest Case - with a Priority Resource</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_4_ciw/ex_4_ciw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 4: A ciw Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_5_simplest_case_wrapped_resources/ex_5_simplest_case_wrapped_resource.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 5: Simplest Case with Higher Number of Resources - Resource Wrapping Demonstration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_6_simplest_case_storewrapper/ex_6_simplest_case.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 6: Simplest Case - VidigiStore demonstration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/example_7_simplest_case_priority_resource_storewrapper/ex_7_simplest_case_priority_resource.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 7: Simplest Case - with a Priority Resource - using new VidigiPriorityStore</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Feature Breakdowns</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../examples/feat_changing_sim_time/feat_changing_sim_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Breakdown: Changing how the date and time are displayed</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Reference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">All Functions</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">All-In-One Animation Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/animation.animate_activity_log.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">animation.animate_activity_log</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Step-By-Step Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/prep.reshape_for_animations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">prep.reshape_for_animations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/prep.generate_animation_df.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">prep.generate_animation_df</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/animation.generate_animation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">animation.generate_animation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Simpy Utility Functions and Classes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.populate_store.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.populate_store</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.CustomResource.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.CustomResource</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.VidigiStore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.VidigiStore</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.VidigiPriorityStore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.VidigiPriorityStore</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.VidigiPriorityStoreLegacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.VidigiPriorityStoreLegacy</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Streamlit Utility Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/utils.streamlit_play_all.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">utils.streamlit_play_all</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">ciw Utility Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reference/ciw.event_log_from_ciw_recs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ciw.event_log_from_ciw_recs</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Other</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vidigi_docs/vidigi_vs_bupar.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Vidigi vs BupaR</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../vidigi_docs/vidigi_vs_bupar.html">Other</a></li><li class="breadcrumb-item"><a href="../vidigi_docs/vidigi_vs_bupar.html">Vidigi vs BupaR</a></li></ol></nav></header>      <div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="cell-0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> examples.example_2_branching_multistep.ex_2_model_classes <span class="im">import</span> Trial, g</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div id="cell-1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>g.sim_duration <span class="op">=</span> <span class="dv">3000</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>g.number_of_runs <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Imported Code, which has had logging steps added at the appropriate points in the â€˜modelâ€™ class
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> simpy</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sim_tools.distributions <span class="im">import</span> Exponential, Lognormal, Uniform, Normal, Bernoulli</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vidigi.utils <span class="im">import</span> populate_store</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> examples.simulation_utility_functions <span class="im">import</span> trace</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Class to store global parameter values.  We don't create an instance of this</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># class - we just refer to the class blueprint itself to access the numbers</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inside.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g:</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a scenario to parameterise the simulation model</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">    random_number_set: int, optional (default=DEFAULT_RNG_SET)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Set to control the initial seeds of each stream of pseudo</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">        random numbers used in the model.</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">    n_triage: int</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of triage cubicles</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">    n_reg: int</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of registration clerks</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">    n_exam: int</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of examination rooms</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">    n_trauma: int</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of trauma bays for stablisation</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">    n_cubicles_non_trauma_treat: int</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of non-trauma treatment cubicles</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co">    n_cubicles_trauma_treat: int</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co">        The number of trauma treatment cubicles</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">    triage_mean: float</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean duration of the triage distribution (Exponential)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">    reg_mean: float</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean duration of the registration distribution (Lognormal)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">    reg_var: float</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">        Variance of the registration distribution (Lognormal)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">    exam_mean: float</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean of the examination distribution (Normal)</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">    exam_var: float</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">        Variance of the examination distribution (Normal)</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co">    trauma_mean: float</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean of the trauma stabilisation distribution (Exponential)</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">    trauma_treat_mean: float</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean of the trauma cubicle treatment distribution (Lognormal)</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="co">    trauma_treat_var: float</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="co">        Variance of the trauma cubicle treatment distribution (Lognormal)</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="co">    non_trauma_treat_mean: float</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="co">        Mean of the non trauma treatment distribution</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="co">    non_trauma_treat_var: float</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co">        Variance of the non trauma treatment distribution</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co">    non_trauma_treat_p: float</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co">        Probability non trauma patient requires treatment</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co">    prob_trauma: float</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co">        probability that a new arrival is a trauma patient.</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    random_number_set <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    n_triage<span class="op">=</span><span class="dv">2</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    n_reg<span class="op">=</span><span class="dv">2</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    n_exam<span class="op">=</span><span class="dv">3</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    n_trauma<span class="op">=</span><span class="dv">4</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    n_cubicles_non_trauma_treat<span class="op">=</span><span class="dv">4</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    n_cubicles_trauma_treat<span class="op">=</span><span class="dv">5</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    triage_mean<span class="op">=</span><span class="dv">6</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    reg_mean<span class="op">=</span><span class="dv">8</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    reg_var<span class="op">=</span><span class="dv">2</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    exam_mean<span class="op">=</span><span class="dv">16</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    exam_var<span class="op">=</span><span class="dv">3</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    trauma_mean<span class="op">=</span><span class="dv">90</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    trauma_treat_mean<span class="op">=</span><span class="dv">30</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    trauma_treat_var<span class="op">=</span><span class="dv">4</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    non_trauma_treat_mean<span class="op">=</span><span class="fl">13.3</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    non_trauma_treat_var<span class="op">=</span><span class="dv">2</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    non_trauma_treat_p<span class="op">=</span><span class="fl">0.6</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    prob_trauma<span class="op">=</span><span class="fl">0.12</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    arrival_df<span class="op">=</span><span class="st">"ed_arrivals.csv"</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>    sim_duration <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>    number_of_runs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Class representing patients coming in to the clinic.</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Patient:</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="co">    Class defining details for a patient entity</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, p_id):</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>        <span class="co">'''</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="co">        Constructor method</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co">        Params:</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="co">        -----</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="co">        identifier: int</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="co">            a numeric identifier for the patient.</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="co">        '''</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.identifier <span class="op">=</span> p_id</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Time of arrival in model/at centre</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.arrival <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Total time in pathway</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.total_time <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shared waits</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wait_triage <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wait_reg <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wait_treat <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Non-trauma pathway - examination wait</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wait_exam <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Trauma pathway - stabilisation wait</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wait_trauma <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shared durations</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.triage_duration <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.reg_duration <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.treat_duration <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Non-trauma pathway - examination duration</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exam_duration <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Trauma pathway - stabilisation duration</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_duration <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Class representing our model of the clinic.</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Model:</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="co">    Simulates the simplest minor treatment process for a patient</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a><span class="co">    1. Arrive</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="co">    2. Examined/treated by nurse when one available</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a><span class="co">    3. Discharged</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Constructor to set up the model for a run.  We pass in a run number when</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we create a new model.</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, run_number):</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a SimPy environment in which everything will live</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.env <span class="op">=</span> simpy.Environment()</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log <span class="op">=</span> []</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a patient counter (which we'll use as a patient ID)</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.patient_counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_patients <span class="op">=</span> []</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.non_trauma_patients <span class="op">=</span> []</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create our resources</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_resources()</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store the passed in run number</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.run_number <span class="op">=</span> run_number</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a new Pandas DataFrame that will store some results against</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the patient ID (which we'll use as the index).</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results_df[<span class="st">"Patient ID"</span>] <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results_df[<span class="st">"Queue Time Cubicle"</span>] <span class="op">=</span> [<span class="fl">0.0</span>]</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results_df[<span class="st">"Time with Nurse"</span>] <span class="op">=</span> [<span class="fl">0.0</span>]</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.results_df.set_index(<span class="st">"Patient ID"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create an attribute to store the mean queuing times across this run of</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the model</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_q_time_cubicle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>        <span class="co"># create distributions</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Triage duration</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.triage_dist <span class="op">=</span> Exponential(g.triage_mean,</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>                                       random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Registration duration (non-trauma only)</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.reg_dist <span class="op">=</span> Lognormal(g.reg_mean,</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>                                  np.sqrt(g.reg_var),</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>                                  random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluation (non-trauma only)</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exam_dist <span class="op">=</span> Normal(g.exam_mean,</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>                                np.sqrt(g.exam_var),</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>                                random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Trauma/stablisation duration (trauma only)</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_dist <span class="op">=</span> Exponential(g.trauma_mean,</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>                                       random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Non-trauma treatment</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nt_treat_dist <span class="op">=</span> Lognormal(g.non_trauma_treat_mean,</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>                                       np.sqrt(g.non_trauma_treat_var),</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>                                       random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>        <span class="co"># treatment of trauma patients</span></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.treat_dist <span class="op">=</span> Lognormal(g.trauma_treat_mean,</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>                                    np.sqrt(g.non_trauma_treat_var),</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>                                    random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>        <span class="co"># probability of non-trauma patient requiring treatment</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nt_p_treat_dist <span class="op">=</span> Bernoulli(g.non_trauma_treat_p,</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>                                         random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>        <span class="co"># probability of non-trauma versus trauma patient</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.p_trauma_dist <span class="op">=</span> Bernoulli(g.prob_trauma,</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>                                       random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>        <span class="co"># init sampling for non-stationary poisson process</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_nspp()</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_nspp(<span class="va">self</span>):</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>        <span class="co"># read arrival profile</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.arrivals <span class="op">=</span> pd.read_csv(g.arrival_df)  <span class="co"># pylint: disable=attribute-defined-outside-init</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.arrivals[<span class="st">'mean_iat'</span>] <span class="op">=</span> <span class="dv">60</span> <span class="op">/</span> <span class="va">self</span>.arrivals[<span class="st">'arrival_rate'</span>]</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        <span class="co"># maximum arrival rate (smallest time between arrivals)</span></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lambda_max <span class="op">=</span> <span class="va">self</span>.arrivals[<span class="st">'arrival_rate'</span>].<span class="bu">max</span>()  <span class="co"># pylint: disable=attribute-defined-outside-init</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>        <span class="co"># thinning exponential</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.arrival_dist <span class="op">=</span> Exponential(<span class="fl">60.0</span> <span class="op">/</span> <span class="va">self</span>.lambda_max,  <span class="co"># pylint: disable=attribute-defined-outside-init</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>                                            random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>        <span class="co"># thinning uniform rng</span></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.thinning_rng <span class="op">=</span> Uniform(low<span class="op">=</span><span class="fl">0.0</span>, high<span class="op">=</span><span class="fl">1.0</span>,  <span class="co"># pylint: disable=attribute-defined-outside-init</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>                                    random_seed<span class="op">=</span><span class="va">self</span>.run_number<span class="op">*</span>g.random_number_set)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_resources(<span class="va">self</span>):</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>        <span class="co">'''</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a><span class="co">        Init the number of resources</span></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a><span class="co">        and store in the arguments container object</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a><span class="co">        Resource list:</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a><span class="co">            1. Nurses/treatment bays (same thing in this model)</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a><span class="co">        '''</span></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shared Resources</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.triage_cubicles <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_triage,</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>                simpy_store<span class="op">=</span><span class="va">self</span>.triage_cubicles,</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>                sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.registration_cubicles <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_reg,</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>                       simpy_store<span class="op">=</span><span class="va">self</span>.registration_cubicles,</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>                       sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Non-trauma</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exam_cubicles <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_exam,</span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>                       simpy_store<span class="op">=</span><span class="va">self</span>.exam_cubicles,</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>                       sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.non_trauma_treatment_cubicles <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_cubicles_non_trauma_treat,</span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>                       simpy_store<span class="op">=</span><span class="va">self</span>.non_trauma_treatment_cubicles,</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>                       sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Trauma</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_stabilisation_bays <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_trauma,</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>                       simpy_store<span class="op">=</span><span class="va">self</span>.trauma_stabilisation_bays,</span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>                       sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_treatment_cubicles <span class="op">=</span> simpy.Store(<span class="va">self</span>.env)</span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>        populate_store(num_resources<span class="op">=</span>g.n_cubicles_trauma_treat,</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>                       simpy_store<span class="op">=</span><span class="va">self</span>.trauma_treatment_cubicles,</span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>                       sim_env<span class="op">=</span><span class="va">self</span>.env)</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A generator function that represents the DES generator for patient</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>    <span class="co"># arrivals</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generator_patient_arrivals(<span class="va">self</span>):</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>        <span class="co"># We use an infinite loop here to keep doing this indefinitely whilst</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the simulation runs</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.env.now <span class="op">//</span> <span class="dv">60</span>) <span class="op">%</span> <span class="va">self</span>.arrivals.shape[<span class="dv">0</span>]</span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>            lambda_t <span class="op">=</span> <span class="va">self</span>.arrivals[<span class="st">'arrival_rate'</span>].iloc[t]</span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set to a large number so that at least 1 sample taken!</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>            u <span class="op">=</span> np.Inf</span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>            interarrival_time <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>            <span class="co"># reject samples if u &gt;= lambda_t / lambda_max</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> u <span class="op">&gt;=</span> (lambda_t <span class="op">/</span> <span class="va">self</span>.lambda_max):</span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>                interarrival_time <span class="op">+=</span> <span class="va">self</span>.arrival_dist.sample()</span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> <span class="va">self</span>.thinning_rng.sample()</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Freeze this instance of this function in place until the</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>            <span class="co"># inter-arrival time we sampled above has elapsed.  Note - time in</span></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>            <span class="co"># SimPy progresses in "Time Units", which can represent anything</span></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>            <span class="co"># you like (just make sure you're consistent within the model)</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="va">self</span>.env.timeout(interarrival_time)</span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Increment the patient counter by 1 (this means our first patient</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>            <span class="co"># will have an ID of 1)</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.patient_counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Create a new patient - an instance of the Patient Class we</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>            <span class="co"># defined above.  Remember, we pass in the ID when creating a</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>            <span class="co"># patient - so here we pass the patient counter to use as the ID.</span></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> Patient(<span class="va">self</span>.patient_counter)</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>            trace(<span class="ss">f'patient </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>patient_counter<span class="sc">}</span><span class="ss"> arrives at: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.event_log.append(</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'patient'</span>: <span class="va">self</span>.patient_counter,</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'pathway'</span>: <span class="st">'Shared'</span>,</span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event'</span>: <span class="st">'arrival'</span>,</span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event_type'</span>: <span class="st">'arrival_departure'</span>,</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>            <span class="co"># sample if the patient is trauma or non-trauma</span></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>            trauma <span class="op">=</span> <span class="va">self</span>.p_trauma_dist.sample()</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tell SimPy to start up the attend_clinic generator function with</span></span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>            <span class="co"># this patient (the generator function that will model the</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>            <span class="co"># patient's journey through the system)</span></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and store patient in list for later easy access</span></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trauma:</span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>                <span class="co"># create and store a trauma patient to update KPIs.</span></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.trauma_patients.append(p)</span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.env.process(<span class="va">self</span>.attend_trauma_pathway(p))</span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>                <span class="co"># create and store a non-trauma patient to update KPIs.</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.non_trauma_patients.append(p)</span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.env.process(<span class="va">self</span>.attend_non_trauma_pathway(p))</span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A generator function that represents the pathway for a patient going</span></span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>    <span class="co"># through the clinic.</span></span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The patient object is passed in to the generator function so we can</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>    <span class="co"># extract information from / record information to it</span></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> attend_non_trauma_pathway(<span class="va">self</span>, patient):</span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>        <span class="co">'''</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a><span class="co">        simulates the non-trauma/minor treatment process for a patient</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a><span class="co">        1. request and wait for sign-in/triage</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a><span class="co">        2. patient registration</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a><span class="co">        3. examination</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a><span class="co">        4a. percentage discharged</span></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a><span class="co">        4b. remaining percentage treatment then discharge</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a><span class="co">        '''</span></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time of arrival and entered the triage queue</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>        patient.arrival <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'triage_wait_begins'</span>,</span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>        <span class="co">###################################################</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request sign-in/triage</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>        triage_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.triage_cubicles.get()</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for triage</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>        patient.wait_triage <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> patient.arrival</span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> triaged to minors '</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'triage_begins'</span>,</span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: triage_resource.id_attribute</span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample triage duration.</span></span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>        patient.triage_duration <span class="op">=</span> <span class="va">self</span>.triage_dist.sample()</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.triage_duration)</span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'triage </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> complete </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">; '</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_triage<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'triage_complete'</span>,</span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: triage_resource.id_attribute}</span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.triage_cubicles.put(triage_resource)</span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>        <span class="co">#########################################################</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time that entered the registration queue</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>        start_wait <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'MINORS_registration_wait_begins'</span>,</span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>        <span class="co">#########################################################</span></span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request registration clerk</span></span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>        registration_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.registration_cubicles.get()</span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for registration</span></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>        patient.wait_reg <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> start_wait</span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'registration of patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> at '</span></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'MINORS_registration_begins'</span>,</span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: registration_resource.id_attribute</span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample registration duration.</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>        patient.reg_duration <span class="op">=</span> <span class="va">self</span>.reg_dist.sample()</span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.reg_duration)</span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> registered at'</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">; '</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_reg<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'MINORS_registration_complete'</span>,</span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: registration_resource.id_attribute}</span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.registration_cubicles.put(registration_resource)</span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>        <span class="co">########################################################</span></span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time that entered the evaluation queue</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>        start_wait <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'MINORS_examination_wait_begins'</span>,</span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>        <span class="co">#########################################################</span></span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request examination resource</span></span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>        examination_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.exam_cubicles.get()</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for examination to begin</span></span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>        patient.wait_exam <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> start_wait</span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'examination of patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> begins '</span></span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'MINORS_examination_begins'</span>,</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: examination_resource.id_attribute</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample examination duration.</span></span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>        patient.exam_duration <span class="op">=</span> <span class="va">self</span>.exam_dist.sample()</span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.exam_duration)</span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> examination complete '</span></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'at </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">;'</span></span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_exam<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'MINORS_examination_complete'</span>,</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: examination_resource.id_attribute}</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in</span></span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exam_cubicles.put(examination_resource)</span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>        <span class="co">############################################################################</span></span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample if patient requires treatment?</span></span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>        patient.require_treat <span class="op">=</span> <span class="va">self</span>.nt_p_treat_dist.sample()  <span class="co">#pylint: disable=attribute-defined-outside-init</span></span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> patient.require_treat:</span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.event_log.append(</span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event'</span>: <span class="st">'requires_treatment'</span>,</span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event_type'</span>: <span class="st">'attribute_assigned'</span>,</span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>            <span class="co"># record the time that entered the treatment queue</span></span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>            start_wait <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.event_log.append(</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event'</span>: <span class="st">'MINORS_treatment_wait_begins'</span>,</span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>            <span class="co">###################################################</span></span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>            <span class="co"># request treatment cubicle</span></span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>            non_trauma_treatment_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.non_trauma_treatment_cubicles.get()</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>            <span class="co"># record the waiting time for treatment</span></span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>            patient.wait_treat <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> start_wait</span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>            trace(<span class="ss">f'treatment of patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> begins '</span></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.event_log.append(</span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'event'</span>: <span class="st">'MINORS_treatment_begins'</span>,</span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'resource_id'</span>: non_trauma_treatment_resource.id_attribute</span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>            <span class="co"># sample treatment duration.</span></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>            patient.treat_duration <span class="op">=</span> <span class="va">self</span>.nt_treat_dist.sample()</span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.treat_duration)</span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>            trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> treatment complete '</span></span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'at </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">;'</span></span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_treat<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.event_log.append(</span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'pathway'</span>: <span class="st">'Non-Trauma'</span>,</span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'event'</span>: <span class="st">'MINORS_treatment_complete'</span>,</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'resource_id'</span>: non_trauma_treatment_resource.id_attribute}</span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.non_trauma_treatment_cubicles.put(non_trauma_treatment_resource)</span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>        <span class="co">##########################################################################</span></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return to what happens to all patients, regardless of whether they were sampled as needing treatment</span></span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pathway'</span>: <span class="st">'Shared'</span>,</span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>            <span class="st">'event'</span>: <span class="st">'depart'</span>,</span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>            <span class="st">'event_type'</span>: <span class="st">'arrival_departure'</span>,</span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>            <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>        <span class="co"># total time in system</span></span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>        patient.total_time <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> patient.arrival</span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> attend_trauma_pathway(<span class="va">self</span>, patient):</span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>        <span class="co">'''</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a><span class="co">        simulates the major treatment process for a patient</span></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a><span class="co">        1. request and wait for sign-in/triage</span></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a><span class="co">        2. trauma</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a><span class="co">        3. treatment</span></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a><span class="co">        '''</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time of arrival and entered the triage queue</span></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>        patient.arrival <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'triage_wait_begins'</span>,</span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>        <span class="co">###################################################</span></span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request sign-in/triage</span></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>        triage_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.triage_cubicles.get()</span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for triage</span></span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>        patient.wait_triage <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> patient.arrival</span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> triaged to trauma '</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'triage_begins'</span>,</span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>             <span class="st">'resource_id'</span>: triage_resource.id_attribute</span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample triage duration.</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a>        patient.triage_duration <span class="op">=</span> <span class="va">self</span>.triage_dist.sample()</span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.triage_duration)</span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'triage </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> complete </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">; '</span></span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_triage<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'triage_complete'</span>,</span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>             <span class="st">'resource_id'</span>: triage_resource.id_attribute}</span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.triage_cubicles.put(triage_resource)</span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>        <span class="co">###################################################</span></span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time that entered the trauma queue</span></span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a>        start_wait <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'TRAUMA_stabilisation_wait_begins'</span>,</span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a>        <span class="co">###################################################</span></span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request trauma room</span></span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>        trauma_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.trauma_stabilisation_bays.get()</span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'TRAUMA_stabilisation_begins'</span>,</span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: trauma_resource.id_attribute</span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for trauma</span></span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>        patient.wait_trauma <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> start_wait</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample stablisation duration.</span></span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>        patient.trauma_duration <span class="op">=</span> <span class="va">self</span>.trauma_dist.sample()</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.trauma_duration)</span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'stabilisation of patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> at '</span></span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'TRAUMA_stabilisation_complete'</span>,</span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>             <span class="st">'resource_id'</span>: trauma_resource.id_attribute</span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_stabilisation_bays.put(trauma_resource)</span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>        <span class="co">#######################################################</span></span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the time that patient entered the treatment queue</span></span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>        start_wait <span class="op">=</span> <span class="va">self</span>.env.now</span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'queue'</span>,</span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'TRAUMA_treatment_wait_begins'</span>,</span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>        <span class="co">########################################################</span></span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>        <span class="co"># request treatment cubicle</span></span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>        trauma_treatment_resource <span class="op">=</span> <span class="cf">yield</span> <span class="va">self</span>.trauma_treatment_cubicles.get()</span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>        <span class="co"># record the waiting time for trauma</span></span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>        patient.wait_treat <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> start_wait</span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'treatment of patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> at '</span></span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event_type'</span>: <span class="st">'resource_use'</span>,</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>                <span class="st">'event'</span>: <span class="st">'TRAUMA_treatment_begins'</span>,</span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a>                <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>                <span class="st">'resource_id'</span>: trauma_treatment_resource.id_attribute</span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample treatment duration.</span></span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>        patient.treat_duration <span class="op">=</span> <span class="va">self</span>.trauma_dist.sample()</span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="va">self</span>.env.timeout(patient.treat_duration)</span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a>        trace(<span class="ss">f'patient </span><span class="sc">{</span>patient<span class="sc">.</span>identifier<span class="sc">}</span><span class="ss"> treatment complete </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>env<span class="sc">.</span>now<span class="sc">:.3f}</span><span class="ss">; '</span></span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f'waiting time was </span><span class="sc">{</span>patient<span class="sc">.</span>wait_treat<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>             <span class="st">'pathway'</span>: <span class="st">'Trauma'</span>,</span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event_type'</span>: <span class="st">'resource_use_end'</span>,</span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>             <span class="st">'event'</span>: <span class="st">'TRAUMA_treatment_complete'</span>,</span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>             <span class="st">'time'</span>: <span class="va">self</span>.env.now,</span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>             <span class="st">'resource_id'</span>: trauma_treatment_resource.id_attribute}</span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log.append(</span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'patient'</span>: patient.identifier,</span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pathway'</span>: <span class="st">'Shared'</span>,</span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a>            <span class="st">'event'</span>: <span class="st">'depart'</span>,</span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a>            <span class="st">'event_type'</span>: <span class="st">'arrival_departure'</span>,</span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>            <span class="st">'time'</span>: <span class="va">self</span>.env.now}</span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resource is no longer in use, so put it back in the store</span></span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.trauma_treatment_cubicles.put(trauma_treatment_resource)</span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>        <span class="co">#########################################################</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a>        <span class="co"># total time in system</span></span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>        patient.total_time <span class="op">=</span> <span class="va">self</span>.env.now <span class="op">-</span> patient.arrival</span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This method calculates results over a single run.  Here we just calculate</span></span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a mean, but in real world models you'd probably want to calculate more.</span></span>
<span id="cb3-740"><a href="#cb3-740" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_run_results(<span class="va">self</span>):</span>
<span id="cb3-741"><a href="#cb3-741" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Take the mean of the queuing times across patients in this run of the</span></span>
<span id="cb3-742"><a href="#cb3-742" aria-hidden="true" tabindex="-1"></a>        <span class="co"># model.</span></span>
<span id="cb3-743"><a href="#cb3-743" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mean_q_time_cubicle <span class="op">=</span> <span class="va">self</span>.results_df[<span class="st">"Queue Time Cubicle"</span>].mean()</span>
<span id="cb3-744"><a href="#cb3-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-745"><a href="#cb3-745" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The run method starts up the DES entity generators, runs the simulation,</span></span>
<span id="cb3-746"><a href="#cb3-746" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and in turns calls anything we need to generate results for the run</span></span>
<span id="cb3-747"><a href="#cb3-747" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb3-748"><a href="#cb3-748" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Start up our DES entity generators that create new patients.  We've</span></span>
<span id="cb3-749"><a href="#cb3-749" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only got one in this model, but we'd need to do this for each one if</span></span>
<span id="cb3-750"><a href="#cb3-750" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we had multiple generators.</span></span>
<span id="cb3-751"><a href="#cb3-751" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.env.process(<span class="va">self</span>.generator_patient_arrivals())</span>
<span id="cb3-752"><a href="#cb3-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-753"><a href="#cb3-753" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Run the model for the duration specified in g class</span></span>
<span id="cb3-754"><a href="#cb3-754" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.env.run(until<span class="op">=</span>g.sim_duration)</span>
<span id="cb3-755"><a href="#cb3-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-756"><a href="#cb3-756" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Now the simulation run has finished, call the method that calculates</span></span>
<span id="cb3-757"><a href="#cb3-757" aria-hidden="true" tabindex="-1"></a>        <span class="co"># run results</span></span>
<span id="cb3-758"><a href="#cb3-758" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.calculate_run_results()</span>
<span id="cb3-759"><a href="#cb3-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-760"><a href="#cb3-760" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log <span class="op">=</span> pd.DataFrame(<span class="va">self</span>.event_log)</span>
<span id="cb3-761"><a href="#cb3-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-762"><a href="#cb3-762" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.event_log[<span class="st">"run"</span>] <span class="op">=</span> <span class="va">self</span>.run_number</span>
<span id="cb3-763"><a href="#cb3-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-764"><a href="#cb3-764" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">'results'</span>: <span class="va">self</span>.results_df, <span class="st">'event_log'</span>: <span class="va">self</span>.event_log}</span>
<span id="cb3-765"><a href="#cb3-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-766"><a href="#cb3-766" aria-hidden="true" tabindex="-1"></a><span class="co"># Class representing a Trial for our simulation - a batch of simulation runs.</span></span>
<span id="cb3-767"><a href="#cb3-767" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trial:</span>
<span id="cb3-768"><a href="#cb3-768" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The constructor sets up a pandas dataframe that will store the key</span></span>
<span id="cb3-769"><a href="#cb3-769" aria-hidden="true" tabindex="-1"></a>    <span class="co"># results from each run against run number, with run number as the index.</span></span>
<span id="cb3-770"><a href="#cb3-770" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span>  <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb3-771"><a href="#cb3-771" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df_trial_results <span class="op">=</span> pd.DataFrame()</span>
<span id="cb3-772"><a href="#cb3-772" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df_trial_results[<span class="st">"Run Number"</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb3-773"><a href="#cb3-773" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df_trial_results[<span class="st">"Arrivals"</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb3-774"><a href="#cb3-774" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df_trial_results[<span class="st">"Mean Queue Time Cubicle"</span>] <span class="op">=</span> [<span class="fl">0.0</span>]</span>
<span id="cb3-775"><a href="#cb3-775" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df_trial_results.set_index(<span class="st">"Run Number"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-776"><a href="#cb3-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-777"><a href="#cb3-777" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_event_logs <span class="op">=</span> []</span>
<span id="cb3-778"><a href="#cb3-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-779"><a href="#cb3-779" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Method to run a trial</span></span>
<span id="cb3-780"><a href="#cb3-780" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_trial(<span class="va">self</span>):</span>
<span id="cb3-781"><a href="#cb3-781" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Run the simulation for the number of runs specified in g class.</span></span>
<span id="cb3-782"><a href="#cb3-782" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each run, we create a new instance of the Model class and call its</span></span>
<span id="cb3-783"><a href="#cb3-783" aria-hidden="true" tabindex="-1"></a>        <span class="co"># run method, which sets everything else in motion.  Once the run has</span></span>
<span id="cb3-784"><a href="#cb3-784" aria-hidden="true" tabindex="-1"></a>        <span class="co"># completed, we grab out the stored run results (just mean queuing time</span></span>
<span id="cb3-785"><a href="#cb3-785" aria-hidden="true" tabindex="-1"></a>        <span class="co"># here) and store it against the run number in the trial results</span></span>
<span id="cb3-786"><a href="#cb3-786" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dataframe.</span></span>
<span id="cb3-787"><a href="#cb3-787" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> run <span class="kw">in</span> <span class="bu">range</span>(g.number_of_runs):</span>
<span id="cb3-788"><a href="#cb3-788" aria-hidden="true" tabindex="-1"></a>            random.seed(run)</span>
<span id="cb3-789"><a href="#cb3-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-790"><a href="#cb3-790" aria-hidden="true" tabindex="-1"></a>            my_model <span class="op">=</span> Model(run)</span>
<span id="cb3-791"><a href="#cb3-791" aria-hidden="true" tabindex="-1"></a>            model_outputs <span class="op">=</span> my_model.run()</span>
<span id="cb3-792"><a href="#cb3-792" aria-hidden="true" tabindex="-1"></a>            patient_level_results <span class="op">=</span> model_outputs[<span class="st">"results"</span>]</span>
<span id="cb3-793"><a href="#cb3-793" aria-hidden="true" tabindex="-1"></a>            event_log <span class="op">=</span> model_outputs[<span class="st">"event_log"</span>]</span>
<span id="cb3-794"><a href="#cb3-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-795"><a href="#cb3-795" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.df_trial_results.loc[run] <span class="op">=</span> [</span>
<span id="cb3-796"><a href="#cb3-796" aria-hidden="true" tabindex="-1"></a>                <span class="bu">len</span>(patient_level_results),</span>
<span id="cb3-797"><a href="#cb3-797" aria-hidden="true" tabindex="-1"></a>                my_model.mean_q_time_cubicle,</span>
<span id="cb3-798"><a href="#cb3-798" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb3-799"><a href="#cb3-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-800"><a href="#cb3-800" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(event_log)</span></span>
<span id="cb3-801"><a href="#cb3-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-802"><a href="#cb3-802" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.all_event_logs.append(event_log)</span>
<span id="cb3-803"><a href="#cb3-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-804"><a href="#cb3-804" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_event_logs <span class="op">=</span> pd.concat(<span class="va">self</span>.all_event_logs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div id="cell-3" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my_trial <span class="op">=</span> Trial()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>my_trial.run_trial()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="cell-4" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my_trial.all_event_logs.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">patient</th>
<th data-quarto-table-cell-role="th">pathway</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">event_type</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">resource_id</th>
<th data-quarto-table-cell-role="th">run</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Shared</td>
<td>arrival</td>
<td>arrival_departure</td>
<td>3.285355</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_wait_begins</td>
<td>queue</td>
<td>3.285355</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.285355</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2</td>
<td>Shared</td>
<td>arrival</td>
<td>arrival_departure</td>
<td>3.289691</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_wait_begins</td>
<td>queue</td>
<td>3.289691</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.289691</td>
<td>2.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_wait_begins</td>
<td>queue</td>
<td>7.364946</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>9.407274</td>
<td>2.0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div id="cell-5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_trial.all_event_logs.event_type.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>event_type
queue                 2100
resource_use          2035
resource_use_end      2021
arrival_departure     1167
attribute_assigned     264
Name: count, dtype: int64</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div id="cell-6" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my_trial.all_event_logs.event.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>event
arrival                             623
triage_wait_begins                  623
triage_begins                       622
triage_complete                     620
depart                              544
MINORS_registration_wait_begins     539
MINORS_registration_begins          514
MINORS_registration_complete        512
MINORS_examination_wait_begins      512
MINORS_examination_begins           475
MINORS_examination_complete         472
requires_treatment                  264
MINORS_treatment_wait_begins        264
MINORS_treatment_begins             264
MINORS_treatment_complete           262
TRAUMA_stabilisation_wait_begins     81
TRAUMA_stabilisation_begins          81
TRAUMA_stabilisation_complete        81
TRAUMA_treatment_wait_begins         81
TRAUMA_treatment_begins              79
TRAUMA_treatment_complete            74
Name: count, dtype: int64</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div id="cell-7" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, identify all patients who have a 'depart' event</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># patients_with_depart = my_trial.all_event_logs[my_trial.all_event_logs['event'].str.contains('depart')]['patient'].unique()</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then filter the original DataFrame to only include those patients</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filtered_df = my_trial.all_event_logs[my_trial.all_event_logs['patient'].isin(patients_with_depart)]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> my_trial.all_event_logs[<span class="op">~</span>my_trial.all_event_logs[<span class="st">'event'</span>].<span class="bu">str</span>.contains(<span class="st">'wait'</span>)].copy()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># logs_transformed = filtered_df[~filtered_df['event'].str.contains('wait')].copy()</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> logs_transformed[logs_transformed[<span class="st">'event_type'</span>].isin([<span class="st">'resource_use'</span>, <span class="st">'resource_use_end'</span>])].copy()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>logs_transformed[<span class="st">'event_stage'</span>] <span class="op">=</span> logs_transformed[<span class="st">'event_type'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'complete'</span> <span class="cf">if</span> <span class="st">'end'</span> <span class="kw">in</span> x <span class="cf">else</span> <span class="st">'start'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>logs_transformed[<span class="st">'event_name'</span>] <span class="op">=</span> logs_transformed[<span class="st">'event'</span>].<span class="bu">str</span>.replace(<span class="st">'_begins|_complete'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>logs_transformed[<span class="st">'resource_id_full'</span>] <span class="op">=</span> logs_transformed.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"</span><span class="sc">{</span>x[<span class="st">'event_name'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>x[<span class="st">'resource_id'</span>]<span class="sc">:.0f}</span><span class="ss">"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> logs_transformed.sort_values([<span class="st">'run'</span>, <span class="st">'time'</span>], ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># logs_transformed["activity_id"] = (</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     logs_transformed.groupby(["run", "patient", "event_name"]).ngroup() + 1</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># logs_transformed = logs_transformed.sort_values(["run", "patient", "activity_id", "event_stage"], ascending=[True, True, True, False])</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the data by run, patient, time, and event_name to handle tied start times</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> logs_transformed.sort_values([<span class="st">"run"</span>, <span class="st">"patient"</span>, <span class="st">"time"</span>, <span class="st">"event_name"</span>])</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the first occurrence of each activity (the start event)</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>first_occurrences <span class="op">=</span> (</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    logs_transformed[logs_transformed[<span class="st">"event_stage"</span>] <span class="op">==</span> <span class="st">"start"</span>]</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    .drop_duplicates([<span class="st">"run"</span>, <span class="st">"patient"</span>, <span class="st">"event_name"</span>])</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    .copy()</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by time within each run to determine the proper sequence</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>first_occurrences <span class="op">=</span> first_occurrences.sort_values([<span class="st">"run"</span>, <span class="st">"time"</span>, <span class="st">"event_name"</span>])</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign sequential activity_id within each run</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>first_occurrences[<span class="st">"activity_id"</span>] <span class="op">=</span> first_occurrences.groupby(<span class="st">"run"</span>).cumcount() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the activity_id back to the main DataFrame</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> logs_transformed.merge(</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    first_occurrences[[<span class="st">"run"</span>, <span class="st">"patient"</span>, <span class="st">"event_name"</span>, <span class="st">"activity_id"</span>]],</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">"run"</span>, <span class="st">"patient"</span>, <span class="st">"event_name"</span>],</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort for final ordering</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>logs_transformed <span class="op">=</span> logs_transformed.sort_values(</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"run"</span>, <span class="st">"patient"</span>, <span class="st">"activity_id"</span>, <span class="st">"event_stage"</span>],</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>logs_transformed.head(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">patient</th>
<th data-quarto-table-cell-role="th">pathway</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">event_type</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">resource_id</th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">event_stage</th>
<th data-quarto-table-cell-role="th">event_name</th>
<th data-quarto-table-cell-role="th">resource_id_full</th>
<th data-quarto-table-cell-role="th">activity_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.285355</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>15.418481</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>15.418481</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>31.636252</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.289691</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>9.407274</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>9.407274</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>17.104670</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>17.104670</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>32.875857</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_begins</td>
<td>resource_use</td>
<td>32.875857</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_1</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_complete</td>
<td>resource_use_end</td>
<td>46.278797</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_1</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>33.426168</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>3</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>33.545008</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>33.545008</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>42.359504</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>42.359504</td>
<td>3.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_3</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>59.468749</td>
<td>3.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_3</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_begins</td>
<td>resource_use</td>
<td>59.468749</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_2</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_complete</td>
<td>resource_use_end</td>
<td>72.510229</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_2</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>4</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>37.900548</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>4</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>37.914164</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>37.914164</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>45.938325</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>45.938325</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>62.120017</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_begins</td>
<td>resource_use</td>
<td>62.120017</td>
<td>3.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_3</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>4</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_complete</td>
<td>resource_use_end</td>
<td>76.274743</td>
<td>3.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_3</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>5</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>51.770459</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>5</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>55.072516</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>5</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>55.072516</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34</td>
<td>5</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>62.243834</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>5</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>62.243834</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>5</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>77.316027</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>18</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>6</td>
<td>Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>113.767200</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38</td>
<td>6</td>
<td>Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>123.546842</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37</td>
<td>6</td>
<td>Trauma</td>
<td>TRAUMA_stabilisation_begins</td>
<td>resource_use</td>
<td>123.546842</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>TRAUMA_stabilisation</td>
<td>TRAUMA_stabilisation_1</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>6</td>
<td>Trauma</td>
<td>TRAUMA_stabilisation_complete</td>
<td>resource_use_end</td>
<td>184.740714</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>TRAUMA_stabilisation</td>
<td>TRAUMA_stabilisation_1</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>6</td>
<td>Trauma</td>
<td>TRAUMA_treatment_begins</td>
<td>resource_use</td>
<td>184.740714</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>TRAUMA_treatment</td>
<td>TRAUMA_treatment_1</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>6</td>
<td>Trauma</td>
<td>TRAUMA_treatment_complete</td>
<td>resource_use_end</td>
<td>186.523313</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>TRAUMA_treatment</td>
<td>TRAUMA_treatment_1</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>7</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>123.044756</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44</td>
<td>7</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>127.086253</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">43</td>
<td>7</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>127.086253</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>7</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>135.479993</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45</td>
<td>7</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>135.479993</td>
<td>3.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_3</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47</td>
<td>7</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>152.106294</td>
<td>3.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_3</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>8</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>124.735469</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>8</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>129.267277</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div id="cell-8" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>logs_transformed[(logs_transformed[<span class="st">"run"</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">&amp;</span> (logs_transformed[<span class="st">"activity_id"</span>]<span class="op">==</span><span class="dv">26</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">patient</th>
<th data-quarto-table-cell-role="th">pathway</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">event_type</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">resource_id</th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">event_stage</th>
<th data-quarto-table-cell-role="th">event_name</th>
<th data-quarto-table-cell-role="th">resource_id_full</th>
<th data-quarto-table-cell-role="th">activity_id</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div id="cell-9" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>logs_transformed[logs_transformed[<span class="st">"activity_id"</span>]<span class="op">==</span><span class="dv">26</span>].sort_values(<span class="st">'run'</span>).head(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">patient</th>
<th data-quarto-table-cell-role="th">pathway</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">event_type</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">resource_id</th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">event_stage</th>
<th data-quarto-table-cell-role="th">event_name</th>
<th data-quarto-table-cell-role="th">resource_id_full</th>
<th data-quarto-table-cell-role="th">activity_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>10</td>
<td>Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>129.468902</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">62</td>
<td>10</td>
<td>Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>165.815421</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>26</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div id="cell-10" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>logs_transformed.sort_values(<span class="st">'activity_id'</span>).head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">patient</th>
<th data-quarto-table-cell-role="th">pathway</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">event_type</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">resource_id</th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">event_stage</th>
<th data-quarto-table-cell-role="th">event_name</th>
<th data-quarto-table-cell-role="th">resource_id_full</th>
<th data-quarto-table-cell-role="th">activity_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.285355</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>3.289691</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>2</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>9.407274</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>7.364946</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>15.418481</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>9.407274</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>17.104670</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_2</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>15.418481</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>31.636252</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_examination_complete</td>
<td>resource_use_end</td>
<td>32.875857</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_examination_begins</td>
<td>resource_use</td>
<td>17.104670</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_examination</td>
<td>MINORS_examination_2</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_begins</td>
<td>resource_use</td>
<td>32.875857</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_1</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2</td>
<td>Non-Trauma</td>
<td>MINORS_treatment_complete</td>
<td>resource_use_end</td>
<td>46.278797</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_treatment</td>
<td>MINORS_treatment_1</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>3</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>33.426168</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>3</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>33.545008</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_1</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_registration_begins</td>
<td>resource_use</td>
<td>33.545008</td>
<td>1.0</td>
<td>0</td>
<td>start</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>3</td>
<td>Non-Trauma</td>
<td>MINORS_registration_complete</td>
<td>resource_use_end</td>
<td>42.359504</td>
<td>1.0</td>
<td>0</td>
<td>complete</td>
<td>MINORS_registration</td>
<td>MINORS_registration_1</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>4</td>
<td>Non-Trauma</td>
<td>triage_complete</td>
<td>resource_use_end</td>
<td>37.914164</td>
<td>2.0</td>
<td>0</td>
<td>complete</td>
<td>triage</td>
<td>triage_2</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>4</td>
<td>Non-Trauma</td>
<td>triage_begins</td>
<td>resource_use</td>
<td>37.900548</td>
<td>2.0</td>
<td>0</td>
<td>start</td>
<td>triage</td>
<td>triage_2</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div id="cell-11" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>logs_transformed[[<span class="st">"event_name"</span>, <span class="st">"event_stage"</span>, <span class="st">"event_type"</span>]].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>event_name            event_stage  event_type      
triage                start        resource_use        622
                      complete     resource_use_end    620
MINORS_registration   start        resource_use        514
                      complete     resource_use_end    512
MINORS_examination    start        resource_use        475
                      complete     resource_use_end    472
MINORS_treatment      start        resource_use        264
                      complete     resource_use_end    262
TRAUMA_stabilisation  complete     resource_use_end     81
                      start        resource_use         81
TRAUMA_treatment      start        resource_use         79
                      complete     resource_use_end     74
Name: count, dtype: int64</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div id="cell-12" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>logs_transformed.event.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>event
triage_begins                    622
triage_complete                  620
MINORS_registration_begins       514
MINORS_registration_complete     512
MINORS_examination_begins        475
MINORS_examination_complete      472
MINORS_treatment_begins          264
MINORS_treatment_complete        262
TRAUMA_stabilisation_begins       81
TRAUMA_stabilisation_complete     81
TRAUMA_treatment_begins           79
TRAUMA_treatment_complete         74
Name: count, dtype: int64</code></pre>
</div>
</div></div>
<div id="cell-13" class="cell markdown">
<p>For ease, now letâ€™s save these results as a file that we can load into R.</p>
<p>We could use a csv for easy interoperability. Alternatively, we could use something like Feather or Parquet, which are usable by both R and Python while retaining data types.</p>
<p>For ease of use and long-term readbility, we will use csv in this case.</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div id="cell-14" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>logs_transformed.to_csv(<span class="st">'simulation_logs_for_bupar.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>


     </main> <!-- /main -->  <script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>  </div> <!-- /content --> 
  
</body></html>